class LteBandInfo {
  final int band;
  final int dlFreqLow;
  final int dlOffset;
  final double dlFreq;

  LteBandInfo({
    required this.band,
    required this.dlFreqLow,
    required this.dlOffset,
    required this.dlFreq,
  });
}


/// 4G LTE EARFCN与频率转换工具
/// 3GPP TS 36.101 Table 5.7.3-1
class LteFrequencyConverter {
  /// LTE频段配置数据 [band, dlFreqLow, ulFreqLow, dlEarfcnStart, ulEarfcnStart, dlEarfcnEnd, ulEarfcnStart2, ulEarfcnEnd, isTdd]
  static final List<List<double>> _bandConfig = [
    [0, 0, 0, 0, 0, 0, 0, 0, 0], // Band 0 (占位)
    [1, 2110, 1920, 0, 18000, 599, 18599, 0, 0], // Band 1
    [2, 1930, 1850, 600, 18600, 1199, 19199, 0, 0], // Band 2
    [3, 1805, 1710, 1200, 19200, 1949, 19949, 0, 0], // Band 3
    [4, 2110, 1710, 1950, 19950, 2399, 20399, 0, 0], // Band 4
    [5, 869, 824, 2400, 20400, 2649, 20649, 0, 0], // Band 5
    [6, 875, 830, 2650, 20650, 2749, 20749, 0, 0], // Band 6
    [7, 2620, 2500, 2750, 20750, 3449, 21449, 0, 0], // Band 7
    [8, 925, 880, 3450, 21450, 3799, 21799, 0, 0], // Band 8
    [9, 1844.9, 1749.9, 3800, 21800, 4149, 22149, 0, 0], // Band 9
    [10, 2110, 1710, 4150, 22150, 4749, 22749, 0, 0], // Band 10
    [11, 1475.9, 1427.9, 4750, 22750, 4949, 22949, 0, 0], // Band 11
    [12, 729, 699, 5010, 23010, 5179, 23179, 0, 0], // Band 12
    [13, 746, 777, 5180, 23180, 5279, 23279, 0, 0], // Band 13
    [14, 758, 788, 5280, 23280, 5379, 23379, 0, 0], // Band 14
    [17, 734, 704, 5730, 23730, 5849, 23849, 0, 0], // Band 17
    [18, 860, 815, 5850, 23850, 5999, 23999, 0, 0], // Band 18
    [19, 875, 830, 6000, 24000, 6149, 24149, 0, 0], // Band 19
    [20, 791, 832, 6150, 24150, 6449, 24449, 0, 0], // Band 20
    [21, 1495.9, 1447.9, 6450, 24450, 6599, 24599, 0, 0], // Band 21
    [22, 3510, 3410, 6600, 24600, 7399, 25399, 0, 0], // Band 22
    [23, 2180, 2000, 7500, 25500, 7699, 25699, 0, 0], // Band 23
    [24, 1525, 1626.5, 7700, 25700, 8039, 26039, 0, 0], // Band 24
    [25, 1930, 1850, 8040, 26040, 8689, 26689, 0, 0], // Band 25
    [26, 859, 814, 8690, 26690, 9039, 27039, 0, 0], // Band 26
    [27, 852, 807, 9040, 27040, 9209, 27209, 0, 0], // Band 27
    [28, 758, 703, 9210, 27210, 9659, 27659, 0, 0], // Band 28
    [29, 717, 0, 9660, 0, 9769, 0, 0, 1], // Band 29 (TDD)
    [30, 2350, 2305, 9770, 27660, 9869, 27759, 0, 0], // Band 30
    [31, 462.5, 452.5, 9870, 27760, 9919, 27809, 0, 0], // Band 31
    [32, 1452, 0, 9920, 0, 10359, 0, 0, 1], // Band 32 (TDD)
    [33, 1900, 1900, 36000, 36000, 36199, 36199, 0, 1], // Band 33 (TDD)
    [34, 2010, 2010, 36200, 36200, 36349, 36349, 0, 1], // Band 34 (TDD)
    [35, 1850, 1930, 36350, 36950, 36949, 37549, 0, 0], // Band 35
    [36, 1930, 1910, 36950, 37550, 37549, 37749, 0, 0], // Band 36
    [37, 1910, 0, 37550, 0, 37749, 0, 0, 1], // Band 37 (TDD)
    [38, 2570, 2570, 37750, 37750, 38249, 38249, 0, 1], // Band 38 (TDD)
    [39, 1880, 1880, 38250, 38250, 38649, 38649, 0, 1], // Band 39 (TDD)
    [40, 2300, 2300, 38650, 38650, 39649, 39649, 0, 1], // Band 40 (TDD)
    [41, 2496, 2496, 39650, 39650, 41589, 41589, 0, 1], // Band 41 (TDD)
    [42, 3400, 3400, 41590, 41590, 43589, 43589, 0, 1], // Band 42 (TDD)
    [43, 3600, 3600, 43590, 43590, 45589, 45589, 0, 1], // Band 43 (TDD)
    [44, 703, 703, 45590, 45590, 46589, 46589, 0, 1], // Band 44 (TDD)
    [45, 1447, 1447, 46590, 46590, 46789, 46789, 0, 1], // Band 45 (TDD)
    [46, 5150, 5150, 46790, 46790, 54539, 54539, 0, 1], // Band 46 (TDD)
    [47, 5855, 5855, 54540, 54540, 55239, 55239, 0, 1], // Band 47 (TDD)
    [65, 2110, 1920, 65536, 131072, 66435, 131971, 0, 0], // Band 65
    [66, 2110, 1710, 66436, 131972, 67335, 132671, 0, 0], // Band 66
    [67, 738, 0, 67336, 0, 67535, 0, 0, 1], // Band 67 (TDD)
    [68, 753, 698, 67536, 132672, 67835, 132971, 0, 0], // Band 68
    [69, 2570, 0, 67836, 0, 68335, 0, 0, 1], // Band 69 (TDD)
    [70, 1995, 1695, 68336, 132972, 68485, 133221, 0, 0], // Band 70
  ];

  /// 将下行EARFCN转换为下行频率(MHz)
  /// F_DL = F_DL_low + 0.1 * (EARFCN - N_DL_offset)
  /// F_UL = F_UL_low + 0.1 * (EARFCN - N_UL_offset)
  // static LteBandInfo dlEarfcnToFrequency(int earfcn) {
  static LteBandInfo getLteBandInfoFromEarfcn(int earfcn) {
    for (var band in _bandConfig) {
      if (band[0] == 0) continue; // 跳过占位符

      double dlEarfcnStart = band[3];
      double dlEarfcnEnd = band[5];

      if (earfcn >= dlEarfcnStart && earfcn <= dlEarfcnEnd) {
        double dlFreqLow = band[1];
        double frequency = dlFreqLow + 0.1 * (earfcn - dlEarfcnStart);
        // return [frequency, band[0]];
        return LteBandInfo(band: band[0].toInt(), dlFreqLow: dlFreqLow.toInt(), dlOffset: dlEarfcnStart.toInt(),dlFreq: frequency);
      }
    }
    throw ArgumentError('无效的EARFCN: $earfcn，不支持该频段');
  }
}
